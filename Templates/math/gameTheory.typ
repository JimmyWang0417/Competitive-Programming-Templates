=== Nim游戏：
  - 规则：有 (n)
    堆石子，玩家轮流从任意一堆取走任意多石子，不能取走最后一颗石子的玩家获胜。
  - 关键结论：状态 $a_1, a_2, dots , a_n$ 是必败状态（$PP$ 态）当且仅当
    Nim 和 $a_1 plus.circle a_2 plus.circle dots plus.circle a_n = 0$。
  - 证明思路：通过博弈图归纳，证明 Nim 和为零时所有后继状态 Nim
    和不为零，反之亦然。
=== Sprague--Grundy 理论：
  - 所有公平组合游戏都等价于一个单堆 Nim 游戏。
  - #strong[SG 函数]：定义 $op("SG")(x) = op("mex"){op("SG")(x') : x' 是 x 的 后 继 状 态 }$。
  - 游戏和的 SG 值：$op("SG")(G_1 + G_2 + dots + G_n) = op("SG")(G_1) plus.circle op("SG")(G_2) plus.circle dots plus.circle op("SG")(G_n)$。
  - #strong[Nim 数]：每个游戏状态对应一个 Nim 数，SG 函数值即为 Nim 数。
=== 常见公平游戏：
==== Bachet 游戏：
规则：有一堆石子，共计 $n$ 枚。两名玩家轮流取走至少 $1$ 枚、至多 $k$ 枚石子。取走最后一枚石子的玩家获胜。

结论：必败当且仅当 $n equiv 0 (mod (k+1))$。

==== Moore's Nim-(k)：
规则：共有 $n$ 堆石子，第 $i$ 堆有 $a_i$ 枚石子。两名玩家轮流取走至少 $1$ 堆、至多 $k$ 堆中的任意多枚石子，但不能不取。取走最后一枚石子的玩家获胜。

结论：必败当且仅当每个二进制位上 $1$ 的个数模 $(k+1)$ 均为 $0$（可以看作 $k$ 进制半加器）。

==== 阶梯 Nim：
规则：共有 $n$ 堆石子，第 $i$ 堆有 $a_i$ 枚石子。两名玩家轮流操作，每次操作中，要么取走第 $1$ 堆石子中的任意多枚，要么将第 $i>1$ 堆石子中的任意多枚移动到第 $i-1$ 堆，但不能不做任何操作。取走最后一枚石子的玩家取胜。

结论：必败当且仅当奇数堆石子的 Nim 和为 0。
==== Fibonacci Nim：
规则：有一堆石子，共计 $n$ 枚。两名玩家轮流取石子。第一个行动的玩家不限制取走的石子数目，但是不能取完石子；随后，每次取走的石子数目不得超过上次（指对手回合）取走的石子数目的二倍。每次取走的石子的数目不得为 $0$。取走最后一枚石子的玩家获胜。

结论：必败当且仅当石子数 $n$ 是 Fibonacci 数。

==== Wythoff 游戏：
规则：有两堆石子，分别有 $a_1$ 和 $a_2$ 枚石子。两名玩家轮流从其中一堆或两堆中取石子，不能不取，但要求从两堆都取石子时，取走的石子数量必须相同。取走最后一枚石子的玩家获胜。

结论：必败状态与黄金分割比 $phi.alt$ 相关，不妨令 $a_1<=a_2$ 即 $a_1 = floor((a_2 - a_1) phi.alt)$ 。
==== 翻硬币游戏：
规则：设 $(S, prec.eq)$ 是一个良基偏序集，映射 $f:S arrow  PP PP S$ 满足对于所有 $s in S$ 集合都有 $f(s)$ 非空，对于 $T in f(s)$ 都有 $s in T$，而且对于所有 $t in T$，都有 $t prec.eq s$。集合 $S$ 的每个元素处都有一枚硬币，可能正面朝上也可能背面朝上。玩家轮流行动，选择一枚正面朝上的硬币 $s$ 和集合 $T in f(s)$，并将集合 $T$ 中所有硬币翻转。将所有硬币都翻转到背面朝上的玩家获胜。

结论：SG 值为所有正面朝上硬币对应基础局面 SG 值的异或。

==== 二分图博弈

规则：两个玩家轮流行动。每个玩家面临的局面都由一个无向图 $G=(V,E)$ 和它的一个顶点 $v in V$ 构成。在一名玩家的回合中，若当前局面为 $(G,v)$，则该玩家必须选择一个与 $v$ 相邻的顶点 $u$。随后，将顶点 $v$ 及其所有关联边从图 $G$ 中删除，得到残余图 $G'$。新的局面即为 $(G',u)$，交由下一位玩家。若某位玩家在其回合开始时，当前顶点 $v$ 在图中没有相邻顶点（即不存在合法选择），则该玩家无法行动，并因此输掉游戏。

结论：游戏先手必胜，当且仅当顶点 $v$ 是图 $G$ 的最大匹配关键点，也就是说，在图 $G$ 的所有最大匹配中，顶点 $v$ 都是匹配点。

=== 反常 Nim 游戏：
  - 规则：取走最后一颗石子的玩家失败。
  - 必败状态：
    - 如果所有堆石子数 $<= 1$，且非空堆数为奇数。
    - 否则，当 Nim 和为 $0$。
=== 有向图游戏：
  - 状态分类：必胜、必败、平局。
  - 算法：使用拓扑排序，从出度为 $0$
    的状态开始，逆向标记必胜和必败状态，未标记状态为平局。

=== 关键概念深入解析
<关键概念深入解析>
==== Sprague--Grundy 定理的应用
<spraguegrundy-定理的应用>
- #strong[本质]：任何公平组合游戏都可以转化为 Nim 游戏，通过计算 SG
  函数值。
- #strong[示例]：在翻硬币游戏中，局面 SG 值是所有正面朝上硬币基础局面 SG
  值的异或。这允许将复杂游戏分解为独立子游戏。

==== 游戏等价性的证明
<游戏等价性的证明>
- 文章通过引理证明游戏等价关系：
  - 引理 1：必败游戏与任何游戏组合等价于原游戏。
  - 引理 2：两个游戏等价当且仅当它们的和是必败游戏。
- 这为 Sprague--Grundy 定理提供了基础，证明所有游戏等价于某个单堆 Nim
  游戏。

==== 反常规则的处理
<反常规则的处理>
- 反常游戏中，胜负条件反转。文章给出了反常 Nim
  的必败条件，并强调这类游戏更复杂，但算法竞赛中较少见。

==== 二分图博弈
<二分图博弈>
- 虽然名称是“二分图博弈”，但结论适用于一般无向图。
- 关键点：先手必胜当且仅当初始顶点是所有最大匹配的关键点。
- 变体：如果先手可以选择初始顶点，则先手必败当且仅当图存在完美匹配。

=== 实用建议
<实用建议>
- #strong[打表法]：对于未知游戏，可以通过暴力计算小规模局面的 SG 值，观察规律，推导通项公式。
- #strong[归纳证明]：在得到 SG 函数表达式后，常用数学归纳法证明其正确性。
- #strong[算法优化]：在计算游戏和时，利用异或性质降低复杂度（如 Nim 和计算为 $O(n)$)。